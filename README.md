# Dynamic API Honeypot System

A sophisticated honeypot that creates realistic, interconnected API endpoints on-the-fly using Google Gemini AI. Features a logical "API maze" that keeps attackers engaged while logging all their activities.

## ğŸ¯ Key Features

### 1. **Realistic API Maze**
- Logical directory structure (`/api/v1/`, `/api/v2/admin/`, `/internal/`)
- Interconnected endpoints with breadcrumbs
- Progressive difficulty levels (public â†’ authenticated â†’ admin â†’ internal)
- Fake authentication system that always succeeds

### 2. **AI-Powered Responses**
- Google Gemini generates context-aware, realistic JSON responses
- Each response includes hints to other endpoints
- Responses feel like a real corporate API

### 3. **Bait File Generation**
- PDF, Excel, and .env files with tracking beacons
- Files trigger alerts when opened
- Realistic content generated by AI

### 4. **State Persistence**
- Endpoints remember what they've generated
- Same path always returns same response (feels real)
- Tracks user objects, downloads, and beacon activations

## ğŸš€ Quick Start

```bash
# 1. Setup
python setup_honeypot.py

# 2. Install dependencies
pip install -r requirements.txt

# 3. Run honeypot
python honeypot.py
```

The honeypot runs on **http://localhost:8001**

## ğŸ“– Documentation

- **[docs/QUICKSTART.md](docs/QUICKSTART.md)** - 5-minute setup guide
- **[docs/API_MAZE_DEMO.md](docs/API_MAZE_DEMO.md)** - See how the maze works
- **[docs/GEMINI_USAGE.md](docs/GEMINI_USAGE.md)** - AI integration guide
- **[docs/TESTING_GUIDE.md](docs/TESTING_GUIDE.md)** - Testing scenarios

## ğŸ¬ Demo

```bash
# Watch an attacker navigate the maze
python tests/demo_maze_attack.py
```

## ğŸ”‘ Gemini API Setup

1. Get free API key: https://makersuite.google.com/app/apikey
2. Edit `src/llm/llm_integration.py` and add your key
3. Restart the honeypot

See [docs/GEMINI_USAGE.md](docs/GEMINI_USAGE.md) for details.

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Attacker Request                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     API Maze Generator                   â”‚
â”‚  â€¢ Checks access level                   â”‚
â”‚  â€¢ Determines auth requirements          â”‚
â”‚  â€¢ Suggests related endpoints            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Gemini AI (if enabled)               â”‚
â”‚  â€¢ Generates realistic response          â”‚
â”‚  â€¢ Adds breadcrumbs to other endpoints   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     State Manager                        â”‚
â”‚  â€¢ Saves endpoint for consistency        â”‚
â”‚  â€¢ Tracks objects and beacons            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Response to Attacker                 â”‚
â”‚  â€¢ JSON with hints to other endpoints    â”‚
â”‚  â€¢ Keeps them exploring                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ Project Structure

```
â”œâ”€â”€ honeypot.py              # Main honeypot entry point
â”œâ”€â”€ requirements.txt         # Dependencies
â”œâ”€â”€ setup_honeypot.py        # Setup script
â”œâ”€â”€ run_honeypot.bat         # Windows launcher
â”œâ”€â”€ run_honeypot.sh          # Linux/Mac launcher
â”œâ”€â”€ src/                     # Source code
â”‚   â”œâ”€â”€ api_generator/       # API maze generation
â”‚   â”‚   â””â”€â”€ maze_generator.py
â”‚   â”œâ”€â”€ llm/                 # AI integration
â”‚   â”‚   â””â”€â”€ llm_integration.py
â”‚   â”œâ”€â”€ file_generator/      # Bait file creation
â”‚   â”‚   â””â”€â”€ generator.py
â”‚   â”œâ”€â”€ state/               # State management
â”‚   â”‚   â””â”€â”€ state_manager.py
â”‚   â””â”€â”€ fine_tuning/         # Model fine-tuning
â”œâ”€â”€ tests/                   # Test files
â”‚   â”œâ”€â”€ test_api_honeypot.py
â”‚   â””â”€â”€ demo_maze_attack.py
â”œâ”€â”€ utils/                   # Utility scripts
â”‚   â”œâ”€â”€ read_logs.py
â”‚   â””â”€â”€ verify_gemini.py
â”œâ”€â”€ docs/                    # Documentation
â”‚   â”œâ”€â”€ QUICKSTART.md
â”‚   â”œâ”€â”€ API_MAZE_DEMO.md
â”‚   â”œâ”€â”€ GEMINI_USAGE.md
â”‚   â””â”€â”€ TESTING_GUIDE.md
â”œâ”€â”€ config/                  # Configuration
â”‚   â””â”€â”€ .env.template
â”œâ”€â”€ databases/               # TinyDB storage
â”œâ”€â”€ generated_files/         # Generated files
â””â”€â”€ log_files/              # Audit logs
```

## ğŸ¯ How the Maze Works

1. **Level 1: Discovery** - Attacker finds `/` with hints to auth
2. **Level 2: Auth Wall** - Endpoints return 401, suggest login
3. **Level 3: Fake Login** - `/api/v1/auth/login` always succeeds
4. **Level 4: User Access** - Get partial data with breadcrumbs
5. **Level 5: Permission Wall** - Admin endpoints return 403
6. **Level 6: Elevation** - `/api/v1/auth/elevate` grants fake admin
7. **Level 7: Admin Access** - "Sensitive" data with internal hints
8. **Level 8: The Loop** - Internal endpoints hint at more...

Every response includes subtle hints keeping them exploring!

## ğŸ”’ Security Notes

âš ï¸ **This is a HONEYPOT for research/education**
- Run in isolated environment
- Monitor logs regularly
- Not for production use
- Review legal implications in your jurisdiction

## ğŸ“Š Monitoring

```bash
# Watch live logs
tail -f log_files/api_audit.log

# Check statistics
curl http://localhost:8001/health
```

## ğŸ“ Educational Use

Perfect for:
- Cybersecurity research
- Thesis/dissertation projects
- Learning about API security
- Understanding attacker behavior
- Demonstrating deception techniques

## ğŸ“„ License

Educational/Research use only. Review local laws before deployment.

## ğŸ™ Credits

Built with:
- FastAPI - Modern Python web framework
- Google Gemini - AI response generation
- TinyDB - Lightweight database
- ReportLab - PDF generation

---

**Created by:** Marco  
**Project:** Maze & Myth - Dynamic Honeypot System  
**Purpose:** Advanced honeypot with realistic API maze architecture
