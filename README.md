# Dynamic API Honeypot System

A sophisticated honeypot that creates realistic, interconnected API endpoints on-the-fly using Google Gemini AI. Features a logical "API maze" that keeps attackers engaged while logging all their activities.

## ğŸ¯ Key Features

### 1. **Realistic API Maze**
- Logical directory structure (`/api/v1/`, `/api/v2/admin/`, `/internal/`)
- Interconnected endpoints with breadcrumbs
- Progressive difficulty levels (public â†’ authenticated â†’ admin â†’ internal)
- Fake authentication system that always succeeds

### 2. **AI-Powered Responses**
- Google Gemini generates context-aware, realistic JSON responses
- Each response includes hints to other endpoints
- Responses feel like a real corporate API

### 3. **Bait File Generation**
- PDF, Excel, and .env files with tracking beacons
- Files trigger alerts when opened
- Realistic content generated by AI

### 4. **State Persistence**
- Endpoints remember what they've generated
- Same path always returns same response (feels real)
- Tracks user objects, downloads, and beacon activations

## ğŸš€ Quick Start

```bash
# 1. Setup
python setup_honeypot.py

# 2. Install dependencies
pip install -r requirements.txt

# 3. Run honeypot
python api_honeypot.py
```

The honeypot runs on **http://localhost:8001**

## ğŸ“– Documentation

- **[QUICKSTART.md](QUICKSTART.md)** - 5-minute setup guide
- **[API_MAZE_DEMO.md](API_MAZE_DEMO.md)** - See how the maze works
- **[GEMINI_USAGE.md](GEMINI_USAGE.md)** - AI integration guide
- **[TESTING_GUIDE.md](TESTING_GUIDE.md)** - Testing scenarios

## ğŸ¬ Demo

```bash
# Watch an attacker navigate the maze
python demo_maze_attack.py
```

## ğŸ”‘ Gemini API Setup

1. Get free API key: https://makersuite.google.com/app/apikey
2. Edit `llm_integration.py` and add your key
3. Restart the honeypot

See [GEMINI_API_SETUP.md](GEMINI_API_SETUP.md) for details.

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Attacker Request                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     API Maze Generator                   â”‚
â”‚  â€¢ Checks access level                   â”‚
â”‚  â€¢ Determines auth requirements          â”‚
â”‚  â€¢ Suggests related endpoints            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Gemini AI (if enabled)               â”‚
â”‚  â€¢ Generates realistic response          â”‚
â”‚  â€¢ Adds breadcrumbs to other endpoints   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     State Manager                        â”‚
â”‚  â€¢ Saves endpoint for consistency        â”‚
â”‚  â€¢ Tracks objects and beacons            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Response to Attacker                 â”‚
â”‚  â€¢ JSON with hints to other endpoints    â”‚
â”‚  â€¢ Keeps them exploring                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ Project Structure

```
â”œâ”€â”€ api_honeypot.py          # Main honeypot server
â”œâ”€â”€ api_maze_generator.py    # Maze logic & breadcrumbs
â”œâ”€â”€ llm_integration.py        # Gemini AI integration
â”œâ”€â”€ state_manager.py          # Database persistence
â”œâ”€â”€ file_generator.py         # Bait file creation
â”œâ”€â”€ api_structure_seed.json   # API categories & tokens
â”œâ”€â”€ requirements.txt          # Dependencies
â”œâ”€â”€ setup_honeypot.py        # Setup script
â”œâ”€â”€ demo_maze_attack.py      # Attack simulation
â”œâ”€â”€ verify_gemini.py         # Test AI integration
â””â”€â”€ databases/               # TinyDB storage
    â””â”€â”€ api_state.json       # Generated endpoints
```

## ğŸ¯ How the Maze Works

1. **Level 1: Discovery** - Attacker finds `/` with hints to auth
2. **Level 2: Auth Wall** - Endpoints return 401, suggest login
3. **Level 3: Fake Login** - `/api/v1/auth/login` always succeeds
4. **Level 4: User Access** - Get partial data with breadcrumbs
5. **Level 5: Permission Wall** - Admin endpoints return 403
6. **Level 6: Elevation** - `/api/v1/auth/elevate` grants fake admin
7. **Level 7: Admin Access** - "Sensitive" data with internal hints
8. **Level 8: The Loop** - Internal endpoints hint at more...

Every response includes subtle hints keeping them exploring!

## ğŸ”’ Security Notes

âš ï¸ **This is a HONEYPOT for research/education**
- Run in isolated environment
- Monitor logs regularly
- Not for production use
- Review legal implications in your jurisdiction

## ğŸ“Š Monitoring

```bash
# Watch live logs
tail -f log_files/api_audit.log

# Check statistics
curl http://localhost:8001/health
```

## ğŸ“ Educational Use

Perfect for:
- Cybersecurity research
- Thesis/dissertation projects
- Learning about API security
- Understanding attacker behavior
- Demonstrating deception techniques

## ğŸ“„ License

Educational/Research use only. Review local laws before deployment.

## ğŸ™ Credits

Built with:
- FastAPI - Modern Python web framework
- Google Gemini - AI response generation
- TinyDB - Lightweight database
- ReportLab - PDF generation

---

**Created by:** Marco  
**Project:** Maze & Myth - Dynamic Honeypot System  
**Purpose:** Advanced honeypot with realistic API maze architecture
